---
title: "Tadpole Mortality"
subtitle: "Métodos Analíticos"
format: pdf
editor: visual
authors:
  - "Mario Medina"
  - "José Eduardo Gutierrez"
  - "Mariano Villafuerte"
---

```{r}
# install.packages(c("coda","mvtnorm","devtools","loo","dagitty","shape"))
# devtools::install_github("rmcelreath/rethinking")

# install.packages("tidyverse")
# install.packages("DiagrammeR")
```

```{r}
#| include: false
library(tidyverse)
library(DiagrammeR)
library(rethinking)
library(ggplot2)
ggplot2::theme_set(ggplot2::theme_light())
```

## Abstract

En nuestro proyecto, utilizamos datos del estudio de Vonesh, J. R. y Bolker, B. M. (2005), el cual examina cómo las ranas de junco del este de África (Hyperolius spinigularis) adaptan sus tiempos de eclosión en respuesta a los depredadores. Este estudio original mostró que, a pesar de las expectativas, las larvas que eclosionaron temprano por presión de los depredadores no solo sobrevivieron, sino que lo hicieron mejor que las larvas de nidadas no perturbadas. Estos hallazgos sugieren que los costos y beneficios asociados con la plasticidad en la eclosión pueden no ser tan directos como se pensaba anteriormente.

Nuestro proyecto toma estos datos y resultados para construir un modelo Bayesiano jerárquico. El objetivo es profundizar en la comprensión de cómo las respuestas compensatorias de las larvas pueden alterar los compromisos tradicionalmente asociados con la plasticidad de eclosión inducida por depredadores. El modelo que desarrollamos intenta capturar la dinámica de crecimiento compensatorio y las tasas de depredación específicas de tamaño y densidad que pueden explicar mejor las altas tasas de supervivencia observadas en las larvas eclosionadas temprano. Nuestros análisis proporcionan una perspectiva más matizada sobre cómo las decisiones de eclosión temprana influyen en la supervivencia y el desarrollo posterior de las ranas, indicando que los verdaderos costos de estas decisiones emergen más adelante en la vida de las larvas.

Este enfoque modela matemáticamente las interacciones complejas y ofrece nuevas vías para entender las estrategias adaptativas en anfibios frente a amenazas ambientales.

## Problema

El conjunto de datos cuenta con información de 48 tanques clasificados en pequeños, medianos y grandes, dependiendo de la densidad de renacuajos en cada uno. Además, disponemos de datos sobre la supervivencia y la tasa de supervivencia en cada tanque. El modelo jerárquico que proponemos pretende capturar estas complejas interacciones entre la densidad, la tasa de supervivencia y otros factores clave para proporcionar una comprensión más profunda de las estrategias adaptativas de las ranas frente a las amenazas de los depredadores.

```{r}
#| code-fold: true
grViz("
digraph {
  graph [ranksep = 0.2, rankdir=LR]
  node [shape=plaintext]
    S
    T
    D
    G
    P
  edge [minlen = 5]
   T -> S
   D -> S
   G -> S
   P -> S
}
", width = 150, height = 40)
```

## Datos

```{r}
data(reedfrogs)
df <- reedfrogs

# Add an index column to the data frame
df$index <- seq.int(nrow(df))

# Calculate the mean of propsurv
mean_propsurv <- mean(df$propsurv)


```

```{r}
# Create the scatterplot with annotations
p <- ggplot(df, aes(x = index, y = propsurv)) +
  geom_point() +
  geom_hline(yintercept = mean_propsurv, linetype = "dashed", color = "black") +
  annotate("text", x = max(df$index) - 23, y = mean_propsurv + 0.05, label = "Promedio de supervivencia en tanques", color = "black", fontface = "italic", hjust = 0) +  
  labs(x = "Tanque", y = "Tasa de Supervivencia") + 
  theme_minimal() +  # Apply minimal theme
  theme(
    axis.title.x = element_text(face = "italic"),
    axis.title.y = element_text(face = "italic")
  ) +
  scale_x_continuous(breaks = c(8, 24, 40), labels = c("1 <= tanques S < 16", "16 <= tanques M < 32", "32 <= tanques L < 48")) +
  geom_vline(xintercept = 16, color = "brown")+
  geom_vline(xintercept = 32, color = "brown")+
  geom_vline(xintercept = 48, color = "brown")


p
```

Hay mucha variación en estos datos. Parte de la variación proviene del tratamiento experimental, pero mucha también proviene de otras fuentes. Pensemos en cada fila como un “tanque,” un entorno experimental que contiene renacuajos. Hay muchas cosas peculiares de cada tanque que no se miden, y estos factores no medidos crean variación en la supervivencia entre tanques, incluso cuando todas las variables predictoras tienen el mismo valor. Se realizan múltiples observaciones, en este caso los renacuajos, dentro de cada grupo
